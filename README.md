# -Hack-Change
Код для Хакатона  Hack&amp;Change команды #ChampCode
## Состав команды
Беленок Анна, Исхакова Эмилия, Петрова Полина, Творогов Тимофей, Зенина Анастасия 


В файле ```versions.txt``` хранится актуальные версии библиотек, необходимые для запуска. 


В файле ```data_analysis_model_building_final.ipynb``` хранится модель предсказания дохода клиентов, оптимизированную под метрику WMAE.

## Обработка данных

Для более качественного прогноза модели мы комбинируем фичи, например: ```df_new['credit_to_income_ratio_12m'] = df_new['turn_cur_cr_avg_act_v2'] / df_new['salary_6to12m_avg'].replace(0, np.nan)```

Также особое внимание уделено категории профессия: например, для молодых людей с пропущенным значением в "профессии" мы предполагаем, что это может быть студент, также как и достаточно взрослый человек с пропущенным значением в профессии может быть пенсионер 

## Модель 

Модель устроена следующим образом: после предобработки фичей и логарифмирования таргета для работы с выбросами мы используем двухступенчатый подход. На первом этапе мы используем Catboost.Classifier для определения классов. Это необходимо для более успешной работы с "хвостами" наших данных. Следующим этапом для каждого из классов (их 2) мы строим отдельную модель CatboostRegressor с отдельным  обучением, подбором гиперпараметров и своими подобранными признаками. Для предсказания мы определниям, к какому классу относятся данные и после используем конкретную программу.

### Дашборд gradio 
Для работы с дашбордом gradio следует в отдельном терминале запустить dashboard_gradio.py через 
```
python dashboard_gradio.py
```
Далее доступен переход на http://localhost:7860/ где доступен необходимый интерфейс.
